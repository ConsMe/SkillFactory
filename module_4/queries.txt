Задание 4.1  

SELECT a.city
FROM dst_project.airports a
GROUP BY a.city
HAVING count(a.airport_code) > 1

Задание 4.2

Вопрос 1
SELECT count(DISTINCT f.status)
FROM dst_project.flights f

Вопрос 2
SELECT count(f.*)
FROM dst_project.flights f
WHERE f.status = 'Departed'

Вопрос 3
SELECT count(s.*)
FROM dst_project.seats s
JOIN dst_project.aircrafts a ON a.aircraft_code = s.aircraft_code
WHERE a.model = 'Boeing 777-300'

Вопрос 4
SELECT count(f.*)
FROM dst_project.flights f
WHERE f.status = 'Arrived'
  AND date(f.actual_arrival) BETWEEN '2017-04-01' AND '2017-09-01'
  
Задание 4.3

Вопрос 1
SELECT count(f.*)
FROM dst_project.flights f
WHERE f.status = 'Cancelled'

Вопрос 2
SELECT count(a.*)
FROM dst_project.aircrafts a
WHERE a.model LIKE '%Boeing%'

SELECT count(a.*)
FROM dst_project.aircrafts a
WHERE a.model LIKE '%Sukhoi Superjet%'

SELECT count(a.*)
FROM dst_project.aircrafts a
WHERE a.model LIKE '%Airbus%'

Вопрос 3
SELECT split_part(a.timezone, '/', 1) world_part,
       count(a.*)
FROM dst_project.airports a
GROUP BY world_part


Вопрос 4
SELECT f.flight_id
FROM dst_project.flights f
WHERE f.actual_arrival IS NOT NULL
ORDER BY (f.actual_arrival - f.scheduled_arrival) DESC
LIMIT 1
